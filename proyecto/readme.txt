This is an upgrade of Pei Liang's bridge simulator.